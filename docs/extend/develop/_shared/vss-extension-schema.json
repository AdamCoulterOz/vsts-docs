{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "type": "object",
    "required": [
        "manifestVersion",
        "id",
        "version",
        "name",
        "publisher",
        "categories",
        "targets"
    ],
    "definitions": {
        "link":{
            "type": "object",
            "properties": {
                "uri": {
                    "type": "string"
                }
            },
            "additionalProperties": false
        }
    },
    "properties": {
        "$schema": {
            "type": "string"
        },
        "manifestVersion": {
            "type": "integer",
            "title": "Manifest Version",
            "description": "The version of the manifest format.",
            "enum": [
                1
            ],
            "default": 1
        },
        "id": {
            "type": "string",
            "title": "Extension Identifier",
            "description": "Must be unique among extensions from the same publisher. \nIt must start with an alphanumeric character and contain only alphanumeric and '-' (hyphen) characters.",
            "pattern": "^\\w{1}(?:\\w|-)*\\w{1}$",
            "examples": [
                "sample-extension",
                "tools"
            ]
        },
        "version": {
            "title": "Extension Version",
            "type": "string",
            "description": "A string specifying the version of an extension. Should be in the format major.minor.patch as per (SemVer)[https://semver.org/].",
            "pattern": "^(0|[1-9]\\d*)\\.(0|[1-9]\\d*)\\.(0|[1-9]\\d*)(?:-((?:0|[1-9]\\d*|\\d*[a-zA-Z-][0-9a-zA-Z-]*)(?:\\.(?:0|[1-9]\\d*|\\d*[a-zA-Z-][0-9a-zA-Z-]*))*))?(?:\\+([0-9a-zA-Z-]+(?:\\.[0-9a-zA-Z-]+)*))?$",
            "examples": [
                "0.1.0",
                "2.4.8",
                "3.0.1"
            ]
        },
        "name": {
            "title": "Extension Name",
            "type": "string",
            "description": "A short, human-readable name of the extension. Limited to 200 characters.",
            "pattern": "^.{3,200}$",
            "examples": [
                "Fabrikam Agile Board Extension"
            ]
        },
        "publisher": {
            "title": "Publisher Identifier",
            "type": "string",
            "description": "This identifier must match the identifier the extension is published under. See (Create and manage a publisher)[https://docs.microsoft.com/en-us/azure/devops/extend/publish/overview].",
            "examples": [
                "fabrikam"
            ]
        },
        "categories": {
            "type": "array",
            "title": "Extension Categories",
            "description": "Categories your extension belongs to. At least one category must be provided and there is no limit to how many categories you may include. \\nUse version >=0.6.3 of the tfx-cli if you are publishing the extension programmatically. \\nIf using Azure DevOps Extension Tasks extension to publish then ensure that its version is >= 1.2.8 (you may need to approve the extension update due to recent scope changes).",
            "items": {
                "type": "string",
                "title": "Azure DevOps Category",
                "enum": [
                    "Azure Repos",
                    "Azure Boards",
                    "Azure Pipelines",
                    "Azure Test Plans",
                    "Azure Artifacts"
                ]
            },
            "additionalItems": false
        },
        "targets": {
            "type": "array",
            "title": "Product Targets",
            "description": "The products and services supported by your integration or extension.",
            "maxItems": 2,
            "minItems": 1,
            "uniqueItems": true,
            "items": {
                "type": "object",
                "required": [
                    "id"
                ],
                "properties": {
                    "id": {
                        "type": "string",
                        "title": "Target Product Identifier",
                        "oneOf": [
                            {
                                "const": "Microsoft.VisualStudio.Services.Cloud",
                                "description": "Works with Azure DevOps Services"
                            },
                            {
                                "const": "Microsoft.TeamFoundation.Server",
                                "description": "Works with Azure DevOps Server"
                            },
                            {
                                "const": "Microsoft.VisualStudio.Services",
                                "description": "Works with both Azure DevOps Services & Server"
                            },
                            {
                                "const": "Microsoft.VisualStudio.Services.Cloud.Integration",
                                "description": "Integrates with Azure DevOps Services"
                            },
                            {
                                "const": "Microsoft.TeamFoundation.Server.Integration",
                                "description": "Integrates with Azure DevOps Server"
                            },
                            {
                                "const": "Microsoft.VisualStudio.Services.Integration",
                                "description": "Integrates with both Azure DevOps Services & Server"
                            }
                        ],
                        "enum": [
                            "Microsoft.VisualStudio.Services",
                            "Microsoft.VisualStudio.Services.Cloud",
                            "Microsoft.VisualStudio.Services.Cloud.Integration",
                            "Microsoft.VisualStudio.Services.Integration",
                            "Microsoft.TeamFoundation.Server",
                            "Microsoft.TeamFoundation.Server.Integration"
                        ]
                    },
                    "version": {
                        "title": "Target Product Minimum Version",
                        "description": "Version of target product required in order to run this extension. NOTE: THIS IS ASSUMED BUT IS UNDOCUMENTED BY MICROSOFT.",
                        "type": "string",
                        "examples": [
                            "[15.2,)",
                            "[15.0,)",
                            "[16.0,)",
                            "[14.4,)",
                            "[17.0,)",
                            "[15.1,)",
                            "[14.3,)"
                        ]
                    }
                },
                "additionalProperties": false
            },
            "additionalItems": false
        },
        "scopes": {
            "type": "array",
            "title": "Authorization Scopes",
            "description": "Authorization scopes providing permissions required by your extension. For example, vso.work and vs.code_write indicates your extension needs read-only access to work items and read/write access to source code (and related resource). Scopes are presented to the user when installing your extension.",
            "items": {
                "type": "string",
                "enum": [
                    "vso.agentpools",
                    "vso.agentpools_manage",
                    "vso.build",
                    "vso.build_execute",
                    "vso.code",
                    "vso.code_write",
                    "vso.code_manage",
                    "vso.code_full",
                    "vso.code_status",
                    "vso.entitlements",
                    "vso.memberentitlementmanagement",
                    "vso.memberentitlementmanagement_write",
                    "vso.extension",
                    "vso.extension_manage",
                    "vso.extension.data",
                    "vso.extension.data_write",
                    "vso.graph",
                    "vso.graph_manage",
                    "vso.identity",
                    "vso.identity_manage",
                    "vso.loadtest",
                    "vso.loadtest_write",
                    "vso.machinegroup_manage",
                    "vso.gallery",
                    "vso.gallery_acquire",
                    "vso.gallery_publish",
                    "vso.gallery_manage",
                    "vso.notification",
                    "vso.notification_write",
                    "vso.notification_manage",
                    "vso.notification_diagnostics",
                    "vso.packaging",
                    "vso.packaging_write",
                    "vso.packaging_manage",
                    "vso.project",
                    "vso.project_write",
                    "vso.project_manage",
                    "vso.release",
                    "vso.release_execute",
                    "vso.release_manage",
                    "vso.security_manage",
                    "vso.serviceendpoint",
                    "vso.serviceendpoint_query",
                    "vso.serviceendpoint_manage",
                    "vso.symbols",
                    "vso.symbols_write",
                    "vso.symbols_manage",
                    "vso.taskgroups_read",
                    "vso.taskgroups_write",
                    "vso.taskgroups_manage",
                    "vso.dashboards",
                    "vso.dashboards_manage",
                    "vso.test",
                    "vso.test_write",
                    "vso.tokens",
                    "vso.tokenadministration",
                    "vso.profile",
                    "vso.profile_write",
                    "vso.variablegroups_read",
                    "vso.variablegroups_write",
                    "vso.variablegroups_manage",
                    "vso.wiki",
                    "vso.wiki_write",
                    "vso.work",
                    "vso.work_write",
                    "vso.work_full"
                ]
            },
            "additionalItems": false
        },
        "demands": {
            "type": "array",
            "title": "Required Capabilities",
            "description": "For example, api-version/3.0 indicates your extension uses version 3.0 APIs and therefore can't run in older products that do not support this version. See the full list of demands.",
            "items": {
                "type": "string",
                "examples": [
                    "environment/cloud",
                    "environment/onprem",
                    "api-version/{minVersion}",
                    "extension/{id}",
                    "contribution/{id}",
                    "contributionType/{id}"
                ]
            },
            "additionalItems": false
        },
        "baseUri": {
            "title": "Base URL",
            "type": "string",
            "description": "Base URL for all relative URLs specified by the extension's contributions. This property should be left empty if your extension's contents are packaged with your extension.",
            "examples": [
                "https://myapp.com/{{account.name}}/"
            ]
        },
        "contributions": {
            "title": "Extension Contributions",
            "description": "Contributions the extension provides.",
            "type": "array",
            "minItems": 1,
            "items": {
                "title": "Contribution Item",
                "type": "object",
                "required": [
                    "id",
                    "type",
                    "targets"
                ],
                "properties": {
                    "id": {
                        "title": "Contribution Identifier",
                        "type": "string",
                        "description": "An identifier for this contribution. Each contribution's ID must be unique within an extension."
                    },
                    "type": {
                        "title": "Contribution Type",
                        "type": "string",
                        "description": "The ID of the contributionType of this contribution.",
                        "enum": [
                            "ms.vss-build-web.build-results-tab",
                            "ms.vss-code-web.editor-items",
                            "ms.vss-continuous-delivery-gallery.devops-dashboard-azure-resource-section-type",
                            "ms.vss-dashboards-web.widget",
                            "ms.vss-dashboards-web.widget-configuration",
                            "ms.vss-distributed-task",
                            "ms.vss-distributed-task.task",
                            "ms.vss-distributed-task.task-input-editor",
                            "ms.vss-endpoint.service-endpoint-type",
                            "ms.vss-releaseManagement-web.release-summary-section",
                            "ms.vss-releaseManagement-web.release-summary-tab",
                            "ms.vss-servicehooks.consumer",
                            "ms.vss-tfs-web.hub-actions-menu",
                            "ms.vss-web.action",
                            "ms.vss-web.action-provider",
                            "ms.vss-web.control",
                            "ms.vss-web.external-content",
                            "ms.vss-web.global-message-banner",
                            "ms.vss-web.hub",
                            "ms.vss-web.hub-group",
                            "ms.vss-web.menu",
                            "ms.vss-web.tab",
                            "ms.vss-work-web.backlog-panel",
                            "ms.vss-work-web.query-column",
                            "ms.vss-work-web.work-item-form-control",
                            "ms.vss-work-web.work-item-form-group",
                            "ms.vss-work-web.work-item-form-page",
                            "ms.vss-work-web.work-item-notifications"
                        ]
                    },
                    "description": {
                        "title": "Contribution Description",
                        "type": "string",
                        "description": "A string describing what the contribution is providing."
                    },
                    "targets": {
                        "title": "Contribution Targets",
                        "type": "array",
                        "description": "Contribution IDs that the contribution is targeting (contributing to). \\nSome contributions act as containers that can be targeted by other contributions. A Hub Group and a Menu are examples of this. Hub contributions can target Hub Groups. When a page is rendered, the web UI shows all Hub contributions that target the selected hub group. Hub groups themselves target a hub group collection which defines a set of hub groups that show up in a given navigational area (e.g. project-level admin pages). \\nMenus can be targeted by contributions of different types: action, hyperlink-action, and action-provider. Actions and hyperlink-actions provide single menu item entries. An action-provider can provide multiple dynamic menu items. For a given menu, items are aggregated across all contributions (of any of these types) that target that specific menu contribution.",
                        "items": {
                            "type": "string",
                            "enum": [
                                "ms.azure-pipelines-agent-job.post-job-tasks",
                                "ms.azure-pipelines-agent-job.pre-job-tasks",
                                "ms.vss-build-web.build-definition-menu",
                                "ms.vss-build-web.build-hub-group",
                                "ms.vss-build-web.build-release-hub-group",
                                "ms.vss-build-web.build-results-view",
                                "ms.vss-build-web.completed-build-menu",
                                "ms.vss-code-web.code-hub-group",
                                "ms.vss-code-web.editor",
                                "ms.vss-code-web.pr-tabs",
                                "ms.vss-code-web.pull-request-action-menu",
                                "ms.vss-code-web.pull-request-status-menu",
                                "ms.vss-code-web.source-item-menu",
                                "ms.vss-continuous-delivery-gallery.devops-dashboard-azure-resource-section",
                                "ms.vss-dashboards-web.dashboards-hub",
                                "ms.vss-dashboards-web.widget-catalog",
                                "ms.vss-dashboards-web.widget-configuration",
                                "ms.vss-distributed-task.task",
                                "ms.vss-distributed-task.task-input-editors",
                                "ms.vss-distributed-task.tasks",
                                "ms.vss-endpoint.endpoint-types",
                                "ms.vss-releaseManagement-web.hub-group-rm",
                                "ms.vss-releaseManagement-web.release-details-summary-tab",
                                "ms.vss-releaseManagement-web.release-details-view",
                                "ms.vss-releaseManagement-web.release-editor-tool-bar-menu",
                                "ms.vss-releaseManagement-web.release-environment-editor-tab",
                                "ms.vss-servicehooks.consumers",
                                "ms.vss-test-web.test-hub-group",
                                "ms.vss-test-web.test-plan-pivot-tabs",
                                "ms.vss-tfs-web.engineering-hub-group",
                                "ms.vss-web.collection-admin-hub-group",
                                "ms.vss-web.home-hub-group",
                                "ms.vss-web.project-admin-hub-group",
                                "ms.vss-web.project-hub-groups-collection",
                                "ms.vss-web.work-hub-group",
                                "ms.vss-wiki-web.wiki-tree-node-menu",
                                "ms.vss-work-web.backlog-item-menu",
                                "ms.vss-work-web.iteration-backlog-tabs",
                                "ms.vss-work-web.iteration-backlog-toolpane",
                                "ms.vss-work-web.portfolio-backlog-toolpane",
                                "ms.vss-work-web.product-backlog-tabs",
                                "ms.vss-work-web.query-result-columns",
                                "ms.vss-work-web.query-result-work-item-menu",
                                "ms.vss-work-web.query-tabs",
                                "ms.vss-work-web.requirement-backlog-toolpane",
                                "ms.vss-work-web.work-hub-group",
                                "ms.vss-work-web.work-item-context-menu",
                                "ms.vss-work-web.work-item-form",
                                "ms.vss-work-web.work-item-query-menu",
                                "ms.vss-work-web.work-item-query-results-toolbar-menu"
                            ]
                        },
                        "additionalItems": false
                    },
                    "properties":{}
                },
                "$ref": "./extn-types/typeReferences.schema.json",
                "additionalProperties": false
            },
            "additionalProperties": false,
            "additionalItems": false
        },
        "contributionTypes": {
            "title": "Extension Contribution Types",
            "description": "Contribution types defined by the extension.",
            "type": "array",
            "items": {
                "type": "object",
                "properties": {
                    "id": {
                        "type": "string"
                    },
                    "name": {
                        "type": "string"
                    },
                    "description": {
                        "type": "string"
                    },
                    "properties": {
                        "type": "object",
                        "properties": {
                            "uri": {
                                "type": "object",
                                "properties": {
                                    "description": {
                                        "type": "string"
                                    },
                                    "type": {
                                        "type": "string"
                                    },
                                    "required": {
                                        "type": "boolean"
                                    }
                                },
                                "additionalProperties": false
                            }
                        },
                        "additionalProperties": false
                    }
                },
                "additionalProperties": false
            },
            "additionalItems": false
        },
        "description": {
            "title": "Extension Description",
            "type": "string",
            "description": "A few sentences describing the extensions. Limited to 200 characters. The description should be your extension's \"elevator pitch\" - a couple of lines to describe your extension in the Marketplace and make people want to install it.",
            "examples": [
                "Awesome tools to help you and your team do great things everyday."
            ],
            "pattern": "^.{3,200}$"
        },
        "icons": {
            "type": [
                "object",
                "array"
            ],
            "items": {
                "items": {},
                "additionalItems": false,
                "additionalProperties": false
            },
            "additionalItems": false,
            "properties": {
                "default": {
                    "type": "string",
                    "examples": [
                        "img/logo.png",
                        "images/logo.png",
                        "marketplace/icon.png"
                    ]
                },
                "large": {
                    "type": "string",
                    "examples": [
                        "icon.svg",
                        "icon-512.png"
                    ]
                },
                "branding": {
                    "type": "string",
                    "enum": [
                        "marketplace/logo.png"
                    ]
                },
                "small": {
                    "type": "string"
                }
            },
            "additionalProperties": false
        },
        "tags": {
            "type": "array",
            "items": {
                "type": "string"
            },
            "additionalItems": false
        },
        "screenshots": {
            "type": "array",
            "items": {
                "type": "object",
                "properties": {
                    "path": {
                        "type": "string",
                        "examples": [
                            "marketplace/screenshot1.png",
                            "marketplace/screenshot2.png"
                        ]
                    }
                },
                "additionalProperties": false
            },
            "additionalItems": false
        },
        "content": {
            "type": "object",
            "properties": {
                "details": {
                    "type": "object",
                    "properties": {
                        "path": {
                            "type": "string",
                            "example": [
                                "overview.md",
                                "readme.md"
                            ]
                        },
                        "license": {
                            "type": "object",
                            "properties": {
                                "path": {
                                    "type": "string"
                                }
                            },
                            "additionalProperties": false
                        },
                        "addressable": {
                            "type": "boolean"
                        }
                    },
                    "additionalProperties": false
                },
                "license": {
                    "type": "object",
                    "properties": {
                        "path": {
                            "type": "string",
                            "example": [
                                "license.md",
                                "license.txt"
                            ]
                        },
                        "contentType": {
                            "type": "string",
                            "enum": [
                                "text/plain"
                            ]
                        }
                    },
                    "additionalProperties": false
                },
                "privacyPolicy": {
                    "type": "object",
                    "properties": {
                        "uri": {
                            "type": "string"
                        },
                        "path": {
                            "type": "string",
                            "enum": [
                                "privacy-policy.md",
                                "PRIVACY.md"
                            ]
                        }
                    },
                    "additionalProperties": false
                },
                "changeLog": {
                    "type": "object",
                    "properties": {
                        "path": {
                            "type": "string",
                            "enum": [
                                "CHANGELOG.md",
                                "changelog.md"
                            ]
                        }
                    },
                    "additionalProperties": false
                },
                "privacy": {
                    "type": "object",
                    "properties": {
                        "path": {
                            "type": "string"
                        }
                    },
                    "additionalProperties": false
                },
                "overview": {
                    "type": "object",
                    "properties": {
                        "path": {
                            "type": "string",
                            "enum": [
                                "overview.md"
                            ]
                        }
                    },
                    "additionalProperties": false
                },
                "thirdPartyNotice": {
                    "type": "object",
                    "properties": {
                        "path": {
                            "type": "string"
                        }
                    },
                    "additionalProperties": false
                }
            },
            "additionalProperties": false
        },
        "links": {
            "type": "object",
            "properties": {
                "home": { "$ref": "#/definitions/link" },
                "getStarted": { "$ref": "#/definitions/link" },
                "learn": { "$ref": "#/definitions/link" },
                "support": { "$ref": "#/definitions/link" },
                "issues": { "$ref": "#/definitions/link" },
                "repository": { "$ref": "#/definitions/link" },
                "privacyPolicy": { "$ref": "#/definitions/link" },
                "screenShots": { "$ref": "#/definitions/link" },
                "license": { "$ref": "#/definitions/link" },
                "terraGrunt": { "$ref": "#/definitions/link" },
                "bigAvocado": { "$ref": "#/definitions/link" },
                "source": { "$ref": "#/definitions/link" },
                "blog": { "$ref": "#/definitions/link" },
                "company": { "$ref": "#/definitions/link" },
                "sourceCode": { "$ref": "#/definitions/link" },
                "pricing": { "$ref": "#/definitions/link" },
                "privacy": { "$ref": "#/definitions/link" },
                "installation": { "$ref": "#/definitions/link" },
                "overview": { "$ref": "#/definitions/link" }
            },
            "additionalProperties": false
        },
        "repository": {
            "type": "object",
            "properties": {
                "type": {
                    "type": "string",
                    "enum": [
                        "git"
                    ]
                },
                "uri": {
                    "type": "string"
                },
                "azDevOps": {
                    "type": "string"
                },
                "url": {
                    "type": "string"
                }
            },
            "additionalProperties": false
        },
        "badges": {
            "type": "array",
            "items": {
                "type": "object",
                "properties": {
                    "href": {
                        "type": "string"
                    },
                    "uri": {
                        "type": "string"
                    },
                    "description": {
                        "type": "string",
                        "examples": [
                            "Azure DevOps Build",
                            "Azure DevOps Release",
                            "CI Build"
                        ]
                    }
                },
                "additionalProperties": false
            },
            "additionalItems": false
        },
        "branding": {
            "type": "object",
            "properties": {
                "color": {
                    "type": "string"
                },
                "theme": {
                    "type": "string",
                    "enum": [
                        "light",
                        "dark"
                    ]
                }
            },
            "additionalProperties": false
        },
        "public": {
            "type": "boolean"
        },
        "files": {
            "type": "array",
            "items": {
                "type": "object",
                "properties": {
                    "path": {
                        "type": "string"
                    },
                    "addressable": {
                        "type": "boolean"
                    },
                    "packagePath": {
                        "type": "string"
                    },
                    "contentType": {
                        "type": "string",
                        "enum": [
                            "text/css",
                            "text/plain",
                            "text/html",
                            "text/javascript",
                            "application/wasm",
                            "application/json"
                        ]
                    }
                },
                "additionalProperties": false
            },
            "additionalItems": false
        },
        "galleryFlags": {
            "type": "array",
            "items": {
                "type": "string",
                "enum": [
                    "Preview",
                    "Public",
                    "Private",
                    "Free",
                    "Paid"
                ]
            },
            "additionalItems": false
        },
        "galleryProperties": {
            "type": "array",
            "items": {
                "type": "object",
                "properties": {
                    "markdownItParser": {
                        "type": "boolean"
                    }
                },
                "additionalProperties": false
            },
            "additionalItems": false
        },
        "customerQnASupport": {
            "type": "object",
            "properties": {
                "enableqna": {
                    "type": "boolean"
                },
                "url": {
                    "type": "string"
                }
            },
            "additionalProperties": false
        }
    },
    "additionalProperties": false
}